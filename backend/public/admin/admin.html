<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Delux Perfumes - Admin Panel</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="styles.css">
<style>
    body {
        margin: 0;
        font-family: "Outfit", sans-serif;
        background: #f8f6f3;
    }
    .sidebar {
        width: 240px;
        background: #1d1d1d;
        color: white;
        height: 100vh;
        position: fixed;
        top: 0;
        left: 0;
        padding-top: 20px;
    }
    .sidebar h2 {
        text-align: center;
        margin-bottom: 20px;
        color: #d4a96a;
        font-family: "Playfair Display", serif;
    }
    .sidebar a {
        display: block;
        padding: 15px 20px;
        color: white;
        text-decoration: none;
        font-size: 16px;
        border-bottom: 1px solid #2d2d2d;
        transition: 0.3s;
    }
    .sidebar a:hover {
        background: #d4a96a;
        color: #1d1d1d;
    }
    .main {
        margin-left: 250px;
        padding: 20px;
    }
    .title {
        font-size: 28px;
        font-weight: bold;
        color: #9d2e33;
        font-family: "Playfair Display", serif;
    }
    .stats {
        display: flex;
        gap: 20px;
        margin: 20px 0;
    }
    .card {
        flex: 1;
        background: white;
        padding: 20px;
        border-radius: 12px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.08);
        text-align: center;
    }
    .card h3 {
        margin: 10px 0;
        font-size: 22px;
        color: #7a1f24;
    }
    .card p {
        font-size: 18px;
        color: #405e4c;
    }
    .welcome {
        background: white;
        padding: 20px;
        border-radius: 12px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.08);
    }
</style>
</head>
<body>

<div class="sidebar">
    <h2>Admin Panel</h2>
    <a href="admin.html">Dashboard</a>
    <a href="products.html">Products</a>
    <a href="orders.html">Orders</a>
    <a href="users.html">Users</a>
</div>

<div class="main">
    <h1 class="title">Welcome Back, Admin!</h1>

    <div class="stats">
        <div class="card">
            <h3 id="totalProducts">0</h3>
            <p>Total Products</p>
        </div>
        <div class="card">
            <h3 id="totalOrders">0</h3>
            <p>Orders Today</p>
        </div>
        <div class="card">
            <h3 id="totalUsers">0</h3>
            <p>Total Users</p>
        </div>
    </div>

    <div class="welcome">
        <h2>Quick Actions</h2>
        <p>Use the sidebar to manage products, view orders, and view users.</p>
        <button onclick="location.href='products.html'" style="padding:10px 20px;margin-top:10px;background:#9d2e33;color:white;border:none;border-radius:6px;cursor:pointer;">Manage Products</button>
        <button onclick="location.href='orders.html'" style="padding:10px 20px;margin-top:10px;background:#d4a96a;color:#1d1d1d;border:none;border-radius:6px;cursor:pointer;">View Orders</button>
    </div>
</div>

<script>
    const API_URL = 'http://localhost:3000';

    async function loadDashboard() {
        try {
           
            const ordersResponse = await fetch(`${API_URL}/orders`);
            const ordersData = await ordersResponse.json();
            
            
            const orders = ordersData.success ? ordersData.orders : [];
            
            
            const productsResponse = await fetch(`${API_URL}/api/products`);
            const products = await productsResponse.json();
            
           
            const usersResponse = await fetch(`${API_URL}/api/users`);
            const users = await usersResponse.json();

           
            document.getElementById('totalProducts').textContent = products.length || 0;
            document.getElementById('totalOrders').textContent = orders.length || 0;
            document.getElementById('totalUsers').textContent = users.length || 0;
            
            console.log('Dashboard loaded:', {
                products: products.length,
                orders: orders.length,
                users: users.length
            });

        } catch (err) {
            console.error('Error fetching dashboard data:', err);
            
            // Show error in console with details
            console.log('Check these endpoints:');
            console.log('1. Orders:', `${API_URL}/orders`);
            console.log('2. Products:', `${API_URL}/api/products`);
            console.log('3. Users:', `${API_URL}/api/users`);
            
            
            const errorDiv = document.createElement('div');
            errorDiv.style.cssText = 'position:fixed; top:20px; right:20px; background:#ff6b6b; color:white; padding:10px; border-radius:5px; z-index:1000;';
            errorDiv.innerHTML = ' Cannot load dashboard data. Check console.';
            document.body.appendChild(errorDiv);
            setTimeout(() => errorDiv.remove(), 5000);
        }
    }

    // Auto-refresh dashboard every 30 seconds
    function startAutoRefresh() {
        setInterval(loadDashboard, 30000); // Refresh every 30 seconds
    }

    document.addEventListener('DOMContentLoaded', () => {
        loadDashboard();
        startAutoRefresh();
    });
</script>

</body>
</html>
